# AutoCalEditor 사용자 매뉴얼

## 목차

1. [프로그램 개요](#프로그램-개요)
2. [시작하기](#시작하기)
3. [사용자 인터페이스](#사용자-인터페이스)
4. [데이터베이스 관리](#데이터베이스-관리)
5. [Navigator 시스템](#navigator-시스템)
6. [Excel 데이터 변환](#excel-데이터-변환)
7. [메뉴바 기능](#메뉴바-기능)
8. [주요 워크플로우](#주요-워크플로우)
9. [문제 해결](#문제-해결)

---

## 프로그램 개요

AutoCalEditor는 Excel 파일과 SQLite 데이터베이스 간의 변환 및 편집을 위한 전문 도구입니다. 코드 생성을 위한 구조화된 데이터 관리와 네비게이션 기능을 제공하여 개발자의 생산성을 향상시킵니다.

### 주요 기능

- **Excel-to-SQLite 변환**: Excel 파일을 SQLite 데이터베이스로 안전하게 변환
- **데이터 무결성 보장**: 트랜잭션 기반 원자적 처리 및 자동 백업
- **Navigator 시스템**: 계층구조 기반 코드 네비게이션 및 OpCode 인식
- **다중 데이터베이스 관리**: 여러 DB 파일 동시 작업 지원
- **Git 통합**: 버전 관리 및 변경 이력 추적
- **코드 생성**: C/C++ 헤더 및 소스 파일 자동 생성

### 시스템 요구사항

- **운영체제**: Windows 10 이상
- **Python**: 3.8 이상
- **메모리**: 최소 4GB RAM
- **저장공간**: 최소 500MB 여유 공간

---

## 시작하기

### 프로그램 실행

1. **명령줄에서 실행**:
   ```bash
   python main.py
   ```

2. **첫 실행 시 설정**:
   - 프로그램이 시작되면 기본 설정이 자동으로 구성됩니다
   - 마지막 사용 디렉토리가 자동으로 저장됩니다

### 초기 화면 구성

프로그램 실행 시 다음과 같은 화면이 표시됩니다:

- **왼쪽 패널**: 파일 트리뷰 및 Navigator
- **오른쪽 패널**: 데이터 그리드뷰
- **상단**: 메뉴바
- **하단**: 상태바 및 Git 정보

---

## 사용자 인터페이스

### 메인 윈도우 구성

#### 1. 왼쪽 패널 (네비게이션 영역)

**파일 트리뷰**
- 열린 데이터베이스 파일들을 트리 구조로 표시
- 각 데이터베이스 내의 시트들을 계층적으로 보여줌
- 우클릭 메뉴를 통한 파일/시트 관리 기능

**Navigator 위젯**
- OpCode 기반 계층구조 네비게이션
- 조건부 블록 및 코드 구조 시각화
- 검색 기능을 통한 빠른 항목 찾기

#### 2. 오른쪽 패널 (데이터 편집 영역)

**Excel 그리드뷰**
- 선택된 시트의 데이터를 스프레드시트 형태로 표시
- 실시간 편집 및 데이터 입력 지원
- 가상화된 렌더링으로 대용량 데이터 처리 최적화

#### 3. 상태바

- 현재 작업 상태 표시
- Git 브랜치 정보 및 상태
- 진행률 표시 (데이터 변환 시)

### 키보드 단축키

| 기능 | 단축키 | 설명 |
|------|--------|------|
| 새 DB 생성 | `Ctrl+N` | 새로운 빈 데이터베이스 생성 |
| DB 파일 열기 | `Ctrl+O` | 기존 DB 파일 열기 |
| Excel 가져오기 | `Ctrl+I` | Excel 파일을 DB로 변환 |
| 저장 | `Ctrl+S` | 현재 변경사항 저장 |
| 실행 취소 | `Ctrl+Z` | 마지막 작업 취소 |
| 다시 실행 | `Ctrl+Y` | 취소한 작업 다시 실행 |
| 종료 | `Ctrl+Q` | 프로그램 종료 |

---

## 데이터베이스 관리

### 새 데이터베이스 생성

1. **메뉴 경로**: 파일 → DB 생성
2. **단축키**: `Ctrl+N`
3. **과정**:
   - 파일 저장 대화상자에서 위치 및 이름 지정
   - 빈 데이터베이스가 생성되고 자동으로 열림
   - 기본 테이블 구조가 자동 생성됨

### 기존 데이터베이스 열기

1. **메뉴 경로**: 파일 → DB 파일 열기
2. **단축키**: `Ctrl+O`
3. **다중 선택 지원**: 여러 DB 파일을 동시에 선택하여 열기 가능
4. **중복 처리**:
   - 동일한 파일이 이미 열려있는 경우 사용자 확인 후 새로 로드
   - "기존 DB를 닫고 새로 다시 여시겠습니까?" 메시지 표시

### 데이터베이스 전환

- **트리뷰에서 선택**: 왼쪽 패널의 트리뷰에서 원하는 DB 클릭
- **자동 전환**: 선택한 DB가 현재 활성 DB로 설정됨
- **상태 표시**: 상태바에 현재 활성 DB 정보 표시

### 안전한 데이터 관리

#### 자동 백업 시스템
- Excel 데이터 가져오기 전 자동 백업 생성
- 타임스탬프 기반 백업 파일명 (`DB이름_backup_YYYYMMDD_HHMMSS.db`)
- 백업 파일은 원본 DB와 동일한 디렉토리에 저장

#### 트랜잭션 관리
- 모든 데이터 변경 작업은 트랜잭션으로 보호
- 오류 발생 시 자동 롤백으로 데이터 무결성 보장
- Excel 가져오기는 전체 파일 수준에서 원자적 처리

---

## Navigator 시스템

Navigator는 AutoCalEditor의 핵심 기능 중 하나로, 코드 구조를 시각적으로 탐색할 수 있게 해주는 고급 네비게이션 도구입니다.

### Navigator 기본 개념

#### OpCode 인식
Navigator는 다음과 같은 OpCode들을 자동으로 인식합니다:

- `$TITLE`: 제목 섹션
- `$SUBTITLE`: 부제목 섹션  
- `$DEFINE`: 정의 섹션
- `$TYPEDEF`: 타입 정의 섹션
- `$ENUM`: 열거형 정의
- `$ARRAY`: 배열 정의
- `$VARIABLE`: 변수 정의
- `$CODE`: 코드 섹션
- `$PRGM_SET` / `$PRGM_END`: 프로그램 블록
- `$PRJT_DEF`: 프로젝트 정의

#### 계층구조 표시
- OpCode에 따른 자동 계층 구조 생성
- 부모-자식 관계 시각화
- 조건부 블록 및 중첩 구조 지원

### Navigator 사용법

#### 1. 기본 네비게이션
- **항목 클릭**: 해당 위치로 그리드뷰 이동
- **계층 확장/축소**: 트리 노드 클릭으로 하위 항목 표시/숨김
- **색상 구분**: OpCode별 다른 색상으로 구분 표시

#### 2. 검색 기능
- Navigator 상단의 검색 상자 활용
- 실시간 필터링으로 원하는 항목 빠르게 찾기
- 대소문자 구분 없는 부분 일치 검색

#### 3. 상태 정보
- Navigator 하단에 로드된 항목 수 표시
- 조건부 블록 개수 별도 표시
- 현재 선택된 항목의 위치 정보 제공

### Navigator 고급 기능

#### 조건부 블록 감지
- `if`, `else`, `endif` 등의 조건부 구조 자동 인식
- 중첩된 조건문 계층 구조 표시
- 조건부 블록 내용 그룹화

#### 계층구조 내보내기
- **메뉴 경로**: 도구 → Navigator 계층구조 내보내기
- 현재 Navigator 구조를 텍스트 파일로 저장
- 디버깅 및 문서화 목적으로 활용 가능

---

## Excel 데이터 변환

AutoCalEditor의 Excel-to-SQLite 변환 기능은 엔터프라이즈급 데이터 무결성을 보장하는 고급 변환 시스템입니다.

### Excel 파일 가져오기

#### 1. 기본 가져오기 과정

1. **메뉴 선택**: 파일 → Excel → DB 변환
2. **단축키**: `Ctrl+I`
3. **파일 선택**: 
   - 단일 또는 다중 Excel 파일 선택 가능
   - 지원 형식: `.xlsx`, `.xls`, `.xlsm`
4. **대상 DB 선택**:
   - 기존 DB에 추가하거나 새 DB 생성
   - 자동 파일명 생성 또는 사용자 지정

#### 2. 변환 과정의 안전장치

**자동 백업 생성**
- 변환 시작 전 기존 DB 자동 백업
- 백업 실패 시에도 변환 진행 (경고 메시지 표시)

**전체 트랜잭션 관리**
- Excel 파일의 모든 시트가 성공하거나 모두 실패
- 부분 성공으로 인한 데이터 불일치 방지
- 오류 발생 시 전체 변경사항 자동 롤백

**중복 파일 처리**
- 동일한 DB 파일이 이미 열려있는 경우:
  - "기존 DB를 닫고 Excel 데이터로 새로 생성하시겠습니까?" 확인
  - 사용자 선택에 따라 기존 DB 교체 또는 취소

#### 3. 변환 규칙

**시트 처리**
- Excel의 각 워크시트가 DB의 개별 시트로 변환
- 시트명에 `$` 접미사 자동 추가 (예: `Sheet1$`)
- 빈 시트는 자동으로 제외

**데이터 처리**
- 빈 셀은 저장하지 않음 (희소 행렬 방식)
- 수식은 계산된 값으로 변환
- 서식 정보는 제외하고 순수 데이터만 저장

**오류 처리**
- 시트별 독립적 처리로 일부 시트 오류 시에도 다른 시트는 정상 처리
- 상세한 오류 로그 기록
- 사용자에게 친화적인 오류 메시지 제공

### 대용량 파일 처리

#### 성능 최적화
- Cython 기반 고속 데이터 처리 (61.1% 성능 향상)
- 배치 단위 데이터 삽입으로 메모리 효율성 극대화
- 가비지 컬렉션 최적화로 메모리 사용량 최소화

#### 진행률 표시
- 실시간 진행률 표시
- 현재 처리 중인 시트 정보 제공
- 예상 완료 시간 표시 (대용량 파일의 경우)

---

## 메뉴바 기능

### 파일 메뉴

#### DB 생성 (Ctrl+N)
- 새로운 빈 SQLite 데이터베이스 생성
- 기본 테이블 구조 자동 설정
- 생성 즉시 활성 DB로 설정

#### DB 파일 열기 (Ctrl+O)
- 기존 SQLite 데이터베이스 파일 열기
- 다중 선택 지원으로 여러 DB 동시 열기
- 중복 파일 감지 및 안전한 처리

#### Excel → DB 변환 (Ctrl+I)
- Excel 파일을 SQLite 데이터베이스로 변환
- 다중 파일 선택 지원
- 엔터프라이즈급 데이터 무결성 보장

#### 최근 파일
- 최근에 사용한 DB 파일 목록 표시
- 빠른 접근을 위한 단축 메뉴
- 최대 10개 파일까지 기록

#### 종료 (Ctrl+Q)
- 모든 변경사항 자동 저장 후 프로그램 종료
- 열린 DB 연결 안전하게 해제

### 편집 메뉴

#### 실행 취소/다시 실행
- **실행 취소 (Ctrl+Z)**: 마지막 편집 작업 취소
- **다시 실행 (Ctrl+Y)**: 취소한 작업 다시 실행
- 다단계 실행 취소 지원

#### 복사/붙여넣기
- **복사 (Ctrl+C)**: 선택된 셀 내용 복사
- **붙여넣기 (Ctrl+V)**: 클립보드 내용 붙여넣기
- Excel과 호환되는 클립보드 형식 지원

#### 찾기/바꾸기
- **찾기 (Ctrl+F)**: 데이터 내 텍스트 검색
- **바꾸기 (Ctrl+H)**: 텍스트 일괄 치환
- 정규식 검색 지원

### 보기 메뉴

#### 확대/축소
- **확대 (Ctrl++)**: 그리드뷰 확대
- **축소 (Ctrl+-)**: 그리드뷰 축소
- **원래 크기 (Ctrl+0)**: 100% 크기로 복원

#### 패널 표시/숨김
- **Navigator 표시/숨김**: Navigator 패널 토글
- **상태바 표시/숨김**: 하단 상태바 토글
- **전체화면 (F11)**: 전체화면 모드 전환

### 도구 메뉴

#### Git 관리
- **Git 상태 보기**: 현재 Git 상태 및 변경사항 확인
- **커밋**: 변경사항을 Git 저장소에 커밋
- **브랜치 전환**: Git 브랜치 변경

#### Navigator 도구
- **계층구조 내보내기**: Navigator 구조를 텍스트 파일로 저장
- **OpCode 검증**: 현재 시트의 OpCode 구조 검증
- **구조 분석**: 데이터 구조 분석 보고서 생성

#### 코드 생성
- **C 헤더 생성**: 현재 데이터를 기반으로 C 헤더 파일 생성
- **C 소스 생성**: 현재 데이터를 기반으로 C 소스 파일 생성
- **전체 코드 생성**: 헤더 및 소스 파일 일괄 생성

### 도움말 메뉴

#### 정보
- **프로그램 정보**: 버전 정보 및 라이선스 표시
- **시스템 정보**: 현재 시스템 환경 정보
- **성능 정보**: 메모리 사용량 및 최적화 상태

#### 지원
- **사용자 매뉴얼**: 온라인 매뉴얼 페이지 열기
- **문제 신고**: GitHub 이슈 페이지 열기
- **업데이트 확인**: 최신 버전 확인

---

## 주요 워크플로우

### 1. Excel 데이터를 DB로 변환하여 편집하기

1. **Excel 파일 준비**
   - 변환할 Excel 파일을 준비합니다
   - 각 워크시트가 의미 있는 데이터 구조를 가지도록 정리합니다

2. **AutoCalEditor에서 변환**
   ```
   파일 → Excel → DB 변환 (Ctrl+I)
   → Excel 파일 선택
   → 대상 DB 위치 지정
   → 변환 실행
   ```

3. **데이터 확인 및 편집**
   - 왼쪽 트리뷰에서 변환된 시트들 확인
   - 각 시트를 선택하여 데이터 검토
   - 필요시 그리드뷰에서 직접 편집

4. **Navigator로 구조 탐색**
   - Navigator 패널에서 OpCode 기반 구조 확인
   - 계층구조를 통한 빠른 네비게이션
   - 검색 기능으로 특정 항목 찾기

### 2. 다중 데이터베이스 작업

1. **여러 DB 파일 열기**
   ```
   파일 → DB 파일 열기 (Ctrl+O)
   → 다중 선택으로 여러 DB 파일 선택
   → 모든 파일이 트리뷰에 표시됨
   ```

2. **DB 간 전환**
   - 트리뷰에서 원하는 DB 클릭
   - 선택된 DB가 현재 활성 DB로 설정
   - 그리드뷰와 Navigator가 자동 업데이트

3. **데이터 비교 및 통합**
   - 여러 DB의 데이터를 비교 분석
   - 필요시 복사/붙여넣기로 데이터 통합
   - 각 DB별 독립적인 편집 작업

### 3. 코드 생성 워크플로우

1. **데이터 구조 설계**
   - OpCode를 사용하여 코드 구조 정의
   - `$TITLE`, `$DEFINE`, `$TYPEDEF` 등으로 섹션 구분
   - Navigator에서 구조 확인

2. **데이터 입력 및 검증**
   - 그리드뷰에서 상세 데이터 입력
   - OpCode 구문 검증
   - Navigator에서 계층구조 확인

3. **코드 생성 실행**
   ```
   도구 → 코드 생성 → C 헤더 생성
   또는
   도구 → 코드 생성 → 전체 코드 생성
   ```

4. **생성된 코드 검토**
   - 생성된 C/C++ 파일 확인
   - 필요시 데이터 수정 후 재생성
   - Git을 통한 버전 관리

---

## 문제 해결

### 일반적인 문제

#### 1. Excel 파일 변환 실패

**증상**: Excel 파일 가져오기 시 오류 발생

**원인 및 해결방법**:
- **파일 권한 문제**: Excel 파일이 다른 프로그램에서 열려있는지 확인
- **파일 손상**: Excel 파일을 다른 프로그램에서 열어 정상 여부 확인
- **메모리 부족**: 대용량 파일의 경우 다른 프로그램 종료 후 재시도
- **경로 문제**: 파일 경로에 특수문자나 한글이 포함되지 않았는지 확인

#### 2. 데이터베이스 연결 오류

**증상**: "attempt to write a readonly database" 오류

**해결방법**:
- DB 파일의 읽기 전용 속성 해제
- 파일이 저장된 폴더의 쓰기 권한 확인
- 다른 프로세스에서 DB 파일을 사용 중인지 확인

#### 3. Navigator가 항목을 인식하지 못함

**증상**: Navigator에 "No navigator items found" 표시

**원인 및 해결방법**:
- **OpCode 형식 확인**: `$TITLE`, `$DEFINE` 등 정확한 OpCode 사용
- **데이터 위치 확인**: OpCode가 올바른 열(A 또는 B)에 위치하는지 확인
- **시트 데이터 확인**: 선택된 시트에 실제 데이터가 있는지 확인

#### 4. 성능 저하

**증상**: 대용량 데이터 처리 시 프로그램이 느려짐

**해결방법**:
- **메모리 확인**: 시스템 메모리 사용량 확인
- **다른 프로그램 종료**: 불필요한 프로그램 종료로 메모리 확보
- **데이터 분할**: 대용량 Excel 파일을 여러 개로 분할하여 처리
- **Cython 최적화 확인**: 로그에서 "성능 최적화 적용 버전" 메시지 확인

### 오류 메시지별 대응

#### "데이터베이스 파일을 찾을 수 없습니다"
- 파일 경로가 올바른지 확인
- 파일이 이동되거나 삭제되지 않았는지 확인
- 네트워크 드라이브의 경우 연결 상태 확인

#### "동일한 이름의 데이터베이스가 이미 열려있습니다"
- 중복된 DB 이름 사용 시 발생
- 기존 DB를 닫거나 다른 이름으로 저장

#### "Excel 파일 가져오기 오류"
- Excel 파일 형식 확인 (.xlsx, .xls, .xlsm)
- 파일 손상 여부 확인
- 충분한 디스크 공간 확인

### 로그 파일 활용

#### 로그 파일 위치
- Windows: `%APPDATA%/AutoCalEditor/logs/`
- 파일명: `autocal_YYYYMMDD.log`

#### 로그 레벨
- **INFO**: 일반적인 작업 정보
- **WARNING**: 주의가 필요한 상황
- **ERROR**: 오류 발생 상황
- **DEBUG**: 상세한 디버깅 정보

#### 문제 신고 시 포함할 정보
1. 발생한 오류의 정확한 메시지
2. 오류 발생 시점의 작업 내용
3. 관련 로그 파일 내용
4. 시스템 환경 정보 (OS, Python 버전 등)

### 성능 최적화 팁

#### 1. 메모리 사용량 최적화
- 불필요한 DB 파일 닫기
- 대용량 시트 작업 후 다른 시트로 전환
- 정기적인 프로그램 재시작

#### 2. 디스크 공간 관리
- 임시 파일 정기 정리
- 백업 파일 보관 정책 수립
- 로그 파일 크기 모니터링

#### 3. 네트워크 환경
- 로컬 디스크에서 작업 후 네트워크로 복사
- VPN 연결 시 성능 저하 가능성 고려

---

## 부록

### 지원되는 파일 형식

#### Excel 파일
- `.xlsx` (Excel 2007 이상)
- `.xls` (Excel 97-2003)
- `.xlsm` (매크로 포함 Excel)

#### 데이터베이스 파일
- `.db` (SQLite 데이터베이스)

#### 내보내기 형식
- `.c` (C 소스 파일)
- `.h` (C 헤더 파일)
- `.txt` (텍스트 파일)

### 기술 지원

#### 온라인 리소스
- **GitHub 저장소**: 최신 버전 및 이슈 트래킹
- **사용자 매뉴얼**: 온라인 문서 및 튜토리얼
- **FAQ**: 자주 묻는 질문과 답변

#### 문제 신고
1. GitHub Issues를 통한 버그 신고
2. 기능 개선 요청
3. 사용법 문의

---

### 시스템 환경 정보

#### 최적화 기능
- **Cython 최적화**: C 수준 성능의 데이터 처리 (61.1% 성능 향상)
- **메모리 풀 관리**: 효율적인 메모리 사용으로 대용량 데이터 처리
- **가상화 렌더링**: 대용량 시트의 부드러운 스크롤 및 편집

#### 호환성
- **Python 3.8+**: 최신 Python 기능 활용
- **PySide6**: 현대적이고 안정적인 GUI 프레임워크
- **SQLite 3**: 경량화된 고성능 데이터베이스 엔진

### 개발자 정보

#### 버전 정보
- **현재 버전**: 2.0
- **빌드 날짜**: 2024년 12월
- **라이선스**: MIT License

#### 주요 개선사항 (v2.0)
- **엔터프라이즈급 데이터 무결성**: 전체 트랜잭션 관리 및 자동 백업
- **Navigator 시스템 대폭 개선**: 계층구조 네비게이션 및 OpCode 인식 강화
- **성능 최적화**: Cython 기반 고속 처리 및 메모리 효율성 개선
- **사용자 경험 향상**: 직관적인 UI 및 안전한 DB 중복 처리

---

*이 매뉴얼은 AutoCalEditor v2.0 기준으로 작성되었습니다.*
*최신 정보는 온라인 문서를 참조하시기 바랍니다.*
