# AutoCalEditor 사용자 매뉴얼

**프로그램 버전**: 2.2
**매뉴얼 버전**: 2.0
**최종 업데이트**: 2024년 12월

---

## 목차

1. [프로그램 소개](#1-프로그램-소개)
2. [시작하기](#2-시작하기)
3. [화면 구성](#3-화면-구성)
4. [데이터베이스 사용법](#4-데이터베이스-사용법)
5. [Excel 파일 변환](#5-excel-파일-변환)
6. [Navigator 사용법](#6-navigator-사용법)
7. [데이터 편집](#7-데이터-편집)
8. [C 코드 생성](#8-c-코드-생성)
9. [메뉴 기능](#9-메뉴-기능)
10. [키보드 단축키](#10-키보드-단축키)
11. [문제 해결](#11-문제-해결)

---

## 1. 프로그램 소개

AutoCalEditor는 Excel 파일을 데이터베이스로 변환하고, 구조화된 데이터를 편집하여 C 코드를 자동 생성하는 도구입니다.

### 주요 기능

- **Excel → DB 변환**: Excel 파일을 SQLite 데이터베이스로 변환
- **데이터 편집**: 스프레드시트 형태로 데이터 편집
- **Navigator**: OpCode 기반 구조 탐색 (색상 구분 표시)
- **C 코드 생성**: 데이터를 기반으로 C 헤더/소스 파일 자동 생성
- **CSV 백업**: 데이터 변경 시 자동 백업

---

## 2. 시작하기

### 프로그램 실행

명령줄에서 다음과 같이 실행합니다:
```bash
python main.py
```

### 화면 구성

프로그램을 실행하면 다음과 같은 화면이 나타납니다:

- **왼쪽 패널**: 파일 목록과 Navigator
- **오른쪽 패널**: 데이터 편집 영역
- **상단**: 메뉴바
- **하단**: 상태바 (Git 정보, 현재 시트 등)

---

## 3. 화면 구성

### 왼쪽 패널

**파일 트리**
- 열린 데이터베이스 파일들을 보여줍니다
- 각 파일 안의 시트들을 트리 형태로 표시
- 시트를 클릭하면 오른쪽에서 편집 가능

**Navigator**
- OpCode 구조를 트리 형태로 보여줍니다
- 검색 기능으로 원하는 항목을 빠르게 찾을 수 있습니다
- 항목을 클릭하면 해당 위치로 이동

### 오른쪽 패널

**데이터 편집 영역**
- Excel과 비슷한 스프레드시트 형태
- 셀을 클릭하여 직접 편집 가능
- 복사, 붙여넣기, 삭제 등 기본 편집 기능 지원

### 상태바

- 현재 Git 브랜치 정보
- 선택된 시트 이름
- 작업 진행 상황

---

## 4. 데이터베이스 사용법

### 새 데이터베이스 만들기

1. **파일 → DB 생성** (또는 Ctrl+N)
2. 저장할 위치와 파일명 입력
3. 빈 데이터베이스가 생성되고 자동으로 열림

### 기존 데이터베이스 열기

1. **파일 → DB 파일 열기** (또는 Ctrl+O)
2. .db 파일 선택
3. 여러 파일을 동시에 선택할 수 있음 (Ctrl 키 사용)

### 동일한 파일을 다시 열 때

이미 열려있는 파일을 다시 선택하면 다음 메시지가 나타납니다:
- "기존 DB를 닫고 새로 다시 여시겠습니까?"
- **예**: 기존 파일을 닫고 새로 열기
- **아니오**: 취소

### 여러 데이터베이스 사용

- 여러 DB 파일을 동시에 열 수 있습니다
- 왼쪽 트리에서 원하는 DB의 시트를 클릭하면 해당 DB로 전환
- 상태바에 현재 활성 DB 정보가 표시됩니다

---

## 5. Excel 파일 변환

### Excel 파일을 데이터베이스로 변환하기

1. **파일 → Excel → DB 변환** (또는 Ctrl+I)
2. 변환할 Excel 파일 선택 (.xlsx, .xls, .xlsm 지원)
3. 저장할 DB 파일 위치와 이름 지정
4. 변환 진행률을 확인하며 완료 대기

### 변환 과정에서 일어나는 일

- Excel의 각 워크시트가 DB의 시트로 변환됩니다
- 시트 이름 뒤에 `$` 기호가 자동으로 추가됩니다
- 빈 셀은 저장하지 않아 용량을 절약합니다
- 변환 전에 자동으로 백업이 생성됩니다

### 안전 기능

- **전체 성공 또는 전체 실패**: 일부 시트만 변환되는 일이 없습니다
- **자동 백업**: 기존 DB가 있으면 변환 전에 백업을 만듭니다
- **오류 시 복구**: 문제가 생기면 변경사항이 자동으로 취소됩니다

### 중복 파일 처리

이미 열려있는 DB와 같은 이름으로 변환하려고 하면:
- "기존 DB를 닫고 Excel 데이터로 새로 생성하시겠습니까?" 메시지 표시
- **예**: 기존 데이터를 모두 삭제하고 Excel 데이터로 교체
- **아니오**: 변환 취소

---

## 6. Navigator 사용법

### Navigator란?

Navigator는 데이터의 구조를 트리 형태로 보여주는 기능입니다. OpCode라는 특별한 키워드를 인식하여 계층구조를 만들어 줍니다.

### 주요 OpCode 및 색상

Navigator가 인식하는 주요 OpCode들과 색상 구분:

- `$TITLE`: 제목 (파란색)
- `$DEFINE`: 상수 정의 (빨간색)
- `$TYPEDEF`: 구조체 정의 (갈색)
- `$ENUM`: 열거형 정의 (보라색)
- `$ARRAY`: 배열 정의 (주황색)
- `$VARIABLE`: 변수 정의 (초록색)
- `$CODE`: 코드 섹션 (회색)

### 사용 방법

1. **구조 보기**: 왼쪽 Navigator 패널에서 데이터 구조를 트리 형태로 확인
2. **색상 구분**: OpCode별로 다른 색상으로 표시 (제목: 파란색, 상수: 빨간색, 열거형: 보라색 등)
3. **이동**: Navigator의 항목을 클릭하면 해당 위치로 이동
4. **검색**: Navigator 상단의 검색창에서 원하는 항목 검색
5. **확장/축소**: `+`, `-` 버튼으로 하위 항목 표시/숨김

### 계층구조 내보내기

**디버그 → Navigator 계층구조 추출** (Ctrl+Shift+N)
- 현재 Navigator 구조를 텍스트 파일로 저장

---

## 7. 데이터 편집

### 기본 편집 방법

#### 셀 편집
1. **셀 선택**: 마우스 클릭 또는 화살표 키
2. **편집 시작**: 더블클릭, F2 키, 또는 바로 타이핑
3. **편집 완료**: Enter 키 또는 다른 셀 클릭

#### 범위 선택
- **드래그**: 마우스로 드래그하여 범위 선택
- **Shift + 화살표**: 키보드로 범위 확장
- **Ctrl + 클릭**: 떨어진 셀들을 개별 선택
- **행/열 전체**: 행 번호나 열 헤더 클릭

### 편집 기능

#### 복사/붙여넣기
- **복사**: Ctrl+C
- **붙여넣기**: Ctrl+V
- **잘라내기**: Ctrl+X
- **지우기**: Delete 키

#### 행/열 관리
- **행 삽입**: Ctrl+R
- **열 삽입**: Ctrl+Shift+I
- **열 삭제**: Ctrl+D
- **실행 취소**: Ctrl+Z
- **다시 실행**: Ctrl+Y

### 찾기/바꾸기

**편집 → 찾기/바꾸기** (Ctrl+H)
- 현재 시트에서 텍스트 검색 및 치환
- 대소문자 구분, 정규식 등 옵션 제공

---

## 8. C 코드 생성

### C 코드 생성이란?

OpCode로 구성된 데이터를 분석하여 C 언어 헤더(.h) 및 소스(.c) 파일을 자동으로 만들어주는 기능입니다.

### 사용 방법

1. **코드 → C 코드 생성** (또는 Ctrl+G)
2. 저장할 위치 선택
3. 자동으로 헤더 파일과 소스 파일이 생성됩니다

### 지원하는 구조

- **매크로 정의**: `$DEFINE` → `#define`
- **구조체**: `$TYPEDEF` → `typedef struct`
- **열거형**: `$ENUM` → `enum`
- **배열**: `$ARRAY` → 배열 선언
- **변수**: `$VARIABLE` → 변수 선언

### 변환 예시

**데이터**:
```
$DEFINE | MAX_SIZE | 1024
$TYPEDEF | Point
$STR_MEM | x | int
$STR_MEM | y | int
```

**생성되는 C 코드**:
```c
#define MAX_SIZE 1024

typedef struct {
    int x;
    int y;
} Point;
```

---

## 9. 메뉴 기능

### 파일 메뉴

- **DB 생성** (Ctrl+N): 새로운 빈 데이터베이스 생성
- **DB 파일 열기** (Ctrl+O): 기존 DB 파일 열기 (다중 선택 가능)
- **Excel → DB 변환** (Ctrl+I): Excel 파일을 DB로 변환
- **CSV 히스토리 생성** (Ctrl+H): 모든 시트를 CSV로 백업
- **현재 시트 저장** (Ctrl+S): 현재 시트 저장
- **종료** (Ctrl+Q): 프로그램 종료

### 편집 메뉴

- **실행 취소** (Ctrl+Z): 마지막 작업 취소
- **다시 실행** (Ctrl+Y): 취소한 작업 다시 실행
- **복사** (Ctrl+C): 선택된 셀 복사
- **붙여넣기** (Ctrl+V): 클립보드 내용 붙여넣기
- **잘라내기** (Ctrl+X): 선택된 셀 잘라내기
- **찾기/바꾸기** (Ctrl+H): 텍스트 검색 및 치환
- **행 삽입** (Ctrl+R): 새 행 삽입
- **열 삽입** (Ctrl+Shift+I): 새 열 삽입
- **열 삭제** (Ctrl+D): 선택된 열 삭제

### 선택 메뉴

- **전체 선택** (Ctrl+A): 현재 시트 전체 선택
- **행 전체 선택** (Shift+Space): 현재 행 전체 선택
- **열 전체 선택** (Ctrl+Space): 현재 열 전체 선택

### 코드 메뉴

- **C 코드 생성** (Ctrl+G): 현재 파일 기반 C 코드 생성

### 디버그 메뉴

- **Navigator 계층구조 추출** (Ctrl+Shift+N): Navigator 구조를 텍스트로 저장

### 도움말 메뉴

- **단축키 목록**: 사용 가능한 키보드 단축키 표시
- **프로그램 정보**: 버전 정보 및 시스템 정보

### CSV 히스토리 기능

**파일 → CSV 히스토리 생성** (Ctrl+H)
- 현재 열린 모든 DB의 시트를 CSV 파일로 백업
- `history/DB명/` 폴더에 시트별 CSV 파일 생성
- Git과 연동하여 변경 이력 추적

### Git 기능

- **자동 상태 표시**: 상태바에 브랜치 및 변경사항 표시
- **변경사항 추적**: DB 및 CSV 파일 변경 자동 감지

---

## 10. 키보드 단축키

### 파일 작업

| 기능 | 단축키 | 설명 |
|------|--------|------|
| 새 DB 생성 | `Ctrl+N` | 새로운 빈 데이터베이스 생성 |
| DB 파일 열기 | `Ctrl+O` | 기존 DB 파일 열기 |
| Excel 가져오기 | `Ctrl+I` | Excel 파일을 DB로 변환 |
| CSV 히스토리 생성 | `Ctrl+H` | 전체 DB의 CSV 히스토리 생성 |
| 현재 시트 저장 | `Ctrl+S` | 현재 시트 변경사항 저장 |
| 프로그램 종료 | `Ctrl+Q` | 애플리케이션 종료 |

### 편집 작업

| 기능 | 단축키 | 설명 |
|------|--------|------|
| 실행 취소 | `Ctrl+Z` | 마지막 작업 취소 |
| 다시 실행 | `Ctrl+Y` | 취소한 작업 다시 실행 |
| 복사 | `Ctrl+C` | 선택된 셀 내용 복사 |
| 붙여넣기 | `Ctrl+V` | 클립보드 내용 붙여넣기 |
| 잘라내기 | `Ctrl+X` | 선택된 셀 내용 잘라내기 |
| 찾기/바꾸기 | `Ctrl+H` | 텍스트 검색 및 치환 |

### 선택 작업

| 기능 | 단축키 | 설명 |
|------|--------|------|
| 전체 선택 | `Ctrl+A` | 현재 시트 전체 선택 |
| 행 전체 선택 | `Shift+Space` | 현재 행 전체 선택 |
| 열 전체 선택 | `Ctrl+Space` | 현재 열 전체 선택 |

### 행/열 관리

| 기능 | 단축키 | 설명 |
|------|--------|------|
| 행 삽입 | `Ctrl+R` | 현재 행 위에 새 행 삽입 |
| 열 삽입 | `Ctrl+Shift+I` | 현재 열 왼쪽에 새 열 삽입 |
| 열 삭제 | `Ctrl+D` | 선택된 열 삭제 |
| 셀 내용 삭제 | `Delete` | 선택된 셀 내용 삭제 |

### 고급 기능

| 기능 | 단축키 | 설명 |
|------|--------|------|
| C 코드 생성 | `Ctrl+G` | 현재 파일 기반 C 코드 생성 |
| Navigator 추출 | `Ctrl+Shift+N` | Navigator 계층구조 텍스트로 저장 |

### 네비게이션

| 기능 | 단축키 | 설명 |
|------|--------|------|
| 셀 편집 시작 | `F2` | 선택된 셀 편집 모드 진입 |
| 편집 완료 | `Enter` | 편집 완료 후 다음 행으로 이동 |
| 편집 취소 | `Esc` | 편집 취소 후 원래 값 복원 |

---

## 11. 문제 해결

### 자주 발생하는 문제

#### Excel 파일 변환 실패
- **Excel 파일이 다른 프로그램에서 열려있는 경우**: Excel을 닫고 다시 시도
- **파일이 손상된 경우**: Excel에서 파일을 다시 저장
- **메모리 부족**: 다른 프로그램을 종료하고 재시도
- **파일 경로에 특수문자 포함**: 영문 경로로 이동 후 재시도

#### 데이터베이스 오류
- **"readonly database" 오류**: 파일의 읽기 전용 속성 해제
- **파일을 찾을 수 없음**: 파일 경로 확인 및 파일 존재 여부 확인
- **권한 문제**: 폴더의 쓰기 권한 확인

#### Navigator 문제
- **"No navigator items found"**: OpCode 형식 확인 (`$TITLE`, `$DEFINE` 등)
- **항목이 표시되지 않음**: OpCode가 A열 또는 B열에 있는지 확인
- **구조가 이상함**: 시트에 실제 데이터가 있는지 확인

#### 성능 문제
- **프로그램이 느림**:
  - 메모리 사용량 확인 (작업 관리자)
  - 불필요한 DB 파일 닫기
  - 프로그램 재시작
- **대용량 파일 처리**: 파일을 여러 개로 분할하여 처리

### 오류 메시지별 해결방법

- **"데이터베이스 파일을 찾을 수 없습니다"**: 파일 경로 확인
- **"동일한 이름의 데이터베이스가 이미 열려있습니다"**: 기존 DB를 닫거나 다른 이름 사용
- **"Excel 파일 가져오기 오류"**: 파일 형식(.xlsx, .xls, .xlsm) 및 권한 확인

---

**프로그램 버전**: 2.2
**매뉴얼 버전**: 2.1
**최종 업데이트**: 2024년 12월

## 버전 정보 수정 내역

**이전 매뉴얼 버전 2.0 표기 이유**: 매뉴얼 작성 시점에서 프로그램의 주요 기능 기준으로 버전을 표기했으나, 실제 프로그램 내부 버전 정보와 불일치 발생

**현재 정정**: 실제 프로그램 버전 2.2에 맞춰 수정 완료